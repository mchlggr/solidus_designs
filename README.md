SpreeItemDesigns
================

This gem extracts all of our design functionality into a seperate gem. It includes designs, templates, design fees and their associated methods.

Noteable changes
================

##Prefences   
A new preference object called Spree::ItemDesign::Config has been created. All objects (designs, templates, design_fees) use this preference object.
It allows us to customize the settings across all our objects. However we cant keep changing this at will, it only provides flexibility for initialization. 

    module Spree
        class ItemDesignConfiguration < Preferences::Configuration
            # Default design types
            preference :types, :array, :default => ["label", "engraving"]

            # Default design sizes
            preference :sizes, :array, :default => ["standard", "wide", "square"]

            # Default image url names
            preference :images, :array, :default => ["large", "medium", "small"]

            # Default tags to filter templates
            preference :tags, :array, :default => [:holidays, :occasions, :recipients]

            preference :upload_your_own_template_id, :integer
        end
    end
    
These preferences behave the same way Spree::Store and others behave. Its actually modeled and instantiate the same.


##Designs
Designs have been refactored to allow for customization around preferences. There are helper methods created to allow us to use methods like standad? which
return true whether or not the design is of standard size. There is validation that checks against the preferences so we cannot create designs without following the configuration.
We also leverage psqls hstore for images now instead of a defining column for each image size. By using hstore we can still call:


    design.small    # get small image url
    design.medium   # get medium image url
    design.large     # get large image url
    
    design.small=   # set small image url
    design.medium=  # set medium image url
    design.large=    # set large image url


These values are just now stored in an hstore column names images. The size names are defined by ```Spree::ItemDesign::Config.images = ["large", "medium", "small"]```.
Also sizes are now strictly names of the actual size eg. "standard" instead of "7:9" all the changes to these have been made pw side in the item_design branch.
Types remain the same.

##Templates
Templates remain roughly the same, but with config preferences mixed in. All the taggings should be moved over to templates though. Right now they are split on pw.
Preferences have been added to templates although we could have the same behavior by using an array column. The tag lists for templates are defined by ```Spree::ItemDesign::Config.tags = [:holidays, :occasions, :recipients]```.
Also templates are now has_many designs but we restrict the number of designs to whatever the size preferences are. Eg. with defaults there can only be one standard, one wide and one square.

##Design Fees
Engraving fees have been refactored into design fees. They act relatively the same mostly just renamed to Spree::DesignFees. One change of note though is that fees now have an active flag.
If a fee is set to inactive then the fee does not alter the cost of a line_item. Fees with 0 value default to inactive. Design fees are applied if they have no design_type specified else its only applied to the designs matching that type. 

###PW changes (item_design branch)
Bunch of migrations (review please)
Fixed template/template_relation
Fixed some sorting by tags that was done on designs instead of templates
Design -> Spree::Design
Template -> Spree::Template
EngravingFee -> Spree::DesignFee

Installation
------------

ONLY DO ON FRESH INSTALL

Add spree_item_designs to your Gemfile:

```ruby
gem 'spree_item_designs'
```

Bundle your dependencies and run the installation generator:

```shell
bundle
bundle exec rails g spree_item_designs:install
```

Testing
-------

First bundle your dependencies, then run `rake`. `rake` will default to building the dummy app if it does not exist, then it will run specs. The dummy app can be regenerated by using `rake test_app DB=postgres`.

```shell
bundle
bundle exec rake
```

When testing your applications integration with this extension you may use it's factories.
Simply add this require statement to your spec_helper:

```ruby
require 'spree_item_designs/factories'
```

Copyright (c) 2014 Personalwine, released under the Step Off License
